<!doctype html><html lang=en><head><meta charset=utf-8><title>Optimizing tests in Spring Boot applications - rapatao.com</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=https://www.rapatao.com/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.rapatao.com/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.rapatao.com/favicon/favicon-16x16.png><link rel=manifest href=https://www.rapatao.com/favicon/site.webmanifest><link rel=mask-icon href=https://www.rapatao.com/favicon/safari-pinned-tab.svg color=#ffffff><link rel="shortcut icon" href=https://www.rapatao.com/favicon/favicon.ico><meta name=msapplication-config content="/favicon/browserconfig.xml"><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><meta name=generator content="Hugo 0.126.1"><meta itemprop=name content="Optimizing tests in Spring Boot applications"><meta itemprop=description content="It is extremely common for applications built with Spring Boot to have all their tests annotated with @SpringBootTest, but it is rare to find people who know the functionality of this annotation, when it is necessary to use it and its impact on the execution of an application’s tests.
You probably thought that this annotation is for building tests, but do you know what it represents, what happens when it is used?"><meta itemprop=datePublished content="2021-06-24T22:00:00-03:00"><meta itemprop=dateModified content="2021-06-24T22:00:00-03:00"><meta itemprop=wordCount content="694"><meta itemprop=image content="https://www.rapatao.com/images/posts/spring-boot-test-performance.png"><meta itemprop=keywords content="Spring,Springboot,Java,Tests"><meta property="og:url" content="https://www.rapatao.com/posts/2021-06/optimizing-tests-in-spring-boot-applications/"><meta property="og:site_name" content="rapatao.com"><meta property="og:title" content="Optimizing tests in Spring Boot applications"><meta property="og:description" content="It is extremely common for applications built with Spring Boot to have all their tests annotated with @SpringBootTest, but it is rare to find people who know the functionality of this annotation, when it is necessary to use it and its impact on the execution of an application’s tests.
You probably thought that this annotation is for building tests, but do you know what it represents, what happens when it is used?"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-06-24T22:00:00-03:00"><meta property="article:modified_time" content="2021-06-24T22:00:00-03:00"><meta property="article:tag" content="Spring"><meta property="article:tag" content="Springboot"><meta property="article:tag" content="Java"><meta property="article:tag" content="Tests"><meta property="og:image" content="https://www.rapatao.com/images/posts/spring-boot-test-performance.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.rapatao.com/images/posts/spring-boot-test-performance.png"><meta name=twitter:title content="Optimizing tests in Spring Boot applications"><meta name=twitter:description content="It is extremely common for applications built with Spring Boot to have all their tests annotated with @SpringBootTest, but it is rare to find people who know the functionality of this annotation, when it is necessary to use it and its impact on the execution of an application’s tests.
You probably thought that this annotation is for building tests, but do you know what it represents, what happens when it is used?"><meta name=twitter:site content="@rapatao"><link rel=stylesheet href=https://www.rapatao.com/css/bundle.min.abec8fc14efbbe295ed4aff7e54c6826d504ca159ff3d50a0c00edff78a8e2c9.css integrity="sha256-q+yPwU77vile1K/35UxoJtUEyhWf89UKDADt/3io4sk="><link rel=stylesheet href=https://www.rapatao.com/css/add-on.css><link rel=alternate hreflang=en href=https://www.rapatao.com/posts/2021-06/optimizing-tests-in-spring-boot-applications/><link rel=alternate hreflang=pt href=https://www.rapatao.com/pt/posts/2021-06/otimizando-testes-em-aplicacoes-com-spring-boot/></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=https://www.rapatao.com/ class=nav>rapatao.com</a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=https://www.rapatao.com/posts/ class="nav link"><i class='far fa-newspaper'></i> Blog</a>
<a href=https://www.rapatao.com/resume/ class="nav link"><i class='far fa-file-alt'></i> Resume</a>
<a href=https://www.rapatao.com/json/ class="nav link"><i class='far fa-file-code'></i> JSON Formatter & Minifier</a>
<a href=#share-menu class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
<a href=#search-input class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a></menu><a href=#search-input class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
<a href=#share-menu class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
<a href=#lang-menu class="nav lang-toggle" lang=en>en</a>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav><menu id=search class=menu><input id=search-input class="search-input menu"></input><div id=search-results class="search-results menu"></div></menu><menu id=lang-menu class="flyout-menu menu"><a href=# lang=en class="nav link active">English (en)</a>
<a href=https://www.rapatao.com/pt/posts/2021-06/otimizando-testes-em-aplicacoes-com-spring-boot/ lang=pt class="nav link">Português (pt)</a></menu><menu id=share-menu class="flyout-menu menu"><h1>Share Post</h1><a href="//twitter.com/share?text=Optimizing%20tests%20in%20Spring%20Boot%20applications&amp;url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank rel=noopener class="nav share-btn twitter"><p>Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank rel=noopener class="nav share-btn facebook"><p>Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f&amp;title=Optimizing%20tests%20in%20Spring%20Boot%20applications" target=_blank rel=noopener class="nav share-btn reddit"><p>Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f&amp;title=Optimizing%20tests%20in%20Spring%20Boot%20applications" target=_blank rel=noopener class="nav share-btn linkedin"><p>LinkedIn</p></a><a href="mailto:?subject=Check%20out%20this%20post%20by &amp;body=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank class="nav share-btn email" data-proofer-ignore><p>Email</p></a></menu></header><div id=wrapper><section id=site-intro><a href=https://www.rapatao.com/><img src=https://www.rapatao.com/images/avatar-pixel.gif class=square width=100 alt="Luiz H. Rapatão"></a><header><h1>Luiz H. Rapatão</h1></header><main><p>Senior Software Engineer</p></main><footer><ul class=socnet-icons><li><a href=//github.com/rapatao target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//linkedin.com/in/rapatao target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//instagram.com/luizrapatao target=_blank rel=noopener title=Instagram class="fab fa-instagram"></a></li><li><a href=//twitter.com/rapatao target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li><li><a href=mailto:rapatao@rapatao.com target=_blank title=Email class="far fa-envelope"></a></li></ul></footer></section><main id=site-main><article class=post><header><div class=title><h2><a href=https://www.rapatao.com/posts/2021-06/optimizing-tests-in-spring-boot-applications/>Optimizing tests in Spring Boot applications</a></h2></div><div class=meta><time datetime="2021-06-24 22:00:00 -0300 -0300">June 24, 2021</time><p>4-Minute Read</p></div></header><div id=socnet-share><a href="//twitter.com/share?text=Optimizing%20tests%20in%20Spring%20Boot%20applications&amp;url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank rel=noopener class="nav share-btn twitter"><p>Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank rel=noopener class="nav share-btn facebook"><p>Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f&amp;title=Optimizing%20tests%20in%20Spring%20Boot%20applications" target=_blank rel=noopener class="nav share-btn reddit"><p>Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f&amp;title=Optimizing%20tests%20in%20Spring%20Boot%20applications" target=_blank rel=noopener class="nav share-btn linkedin"><p>LinkedIn</p></a><a href="mailto:?subject=Check%20out%20this%20post%20by &amp;body=https%3a%2f%2fwww.rapatao.com%2fposts%2f2021-06%2foptimizing-tests-in-spring-boot-applications%2f" target=_blank class="nav share-btn email" data-proofer-ignore><p>Email</p></a></div><div class=content><a href=https://www.rapatao.com/posts/2021-06/optimizing-tests-in-spring-boot-applications/ class=image style="--bg-image:url('https://www.rapatao.com/images/posts/spring-boot-test-performance.png')"><img class=stretchV src=https://www.rapatao.com/images/posts/spring-boot-test-performance.png alt="Optimizing tests in Spring Boot applications"></a><p>It is extremely common for applications built with Spring Boot to have all their tests annotated with <code>@SpringBootTest</code>, but it is rare to find people who know the functionality of this annotation, when it is necessary to use it and its impact on the execution of an application&rsquo;s tests.</p><p>You probably thought that this annotation is for building tests, but do you know what it represents, what happens when it is used?</p><p>Simply put, this annotation is a simplified way of adding an extension to <a href=https://junit.org/junit5/docs/current/user-guide/#extensions>JUnit</a> that aims to initialize the Spring context before the scenarios run of declared tests. With its use, before a test class is executed, the application is searched for the class annotated with <code>@SpringBootApplication</code> to identify possible customizations, loaded the settings for the test profile (when not overwritten) and only after the context be initialized, we have the method with the scenario executed.</p><p>With this in mind, it is interesting to know how to identify the possible impacts that its use can bring to projects.</p><h2 id=the-impact-of-the-springboottest-annotation>The impact of the @SpringBootTest annotation</h2><p>We can consider this annotation a facilitator for the creation of tests, however, its indiscriminate use can add considerable execution time, since, as described above, several operations are performed before the tests are executed.</p><p>When an application has few test scenarios, normally this time will not be noticed, but as applications and application complexities grow, several new test scenarios tend to be included, making the execution time increasingly impactful.</p><p>For reference, an application was created with only one component called **that will return a fixed text when the method is consumed. This application can be summarized in the following classes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@SpringBootApplication</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TempApplication</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        SpringApplication.<span style=color:#a6e22e>run</span>(TempApplication.<span style=color:#a6e22e>class</span>, args);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Service</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TempService</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>get</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Nothing&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Normally, the tests for the <code>TempService</code> class would be implemented as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@SpringBootTest</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TempApplicationTests</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> TempService service;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test</span>() {
</span></span><span style=display:flex><span>        assertEquals(<span style=color:#e6db74>&#34;Nothing&#34;</span>, service.<span style=color:#a6e22e>get</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Like using the <code>@SpringBootTest</code> annotation, we have the <em>Spring</em> context initialized on each test and this simple scenario runs at <code>233ms</code>. This number may seem small, but we are considering only a test class with only one scenario built and we must always remember that real applications tend to have dozens of classes with hundreds of test scenarios, which, theoretically, would make the total time of execution is the multiplication of this quantity.</p><h2 id=how-can-we-optimize-tests>How can we optimize tests?</h2><p>As you can see, the previous test doesn&rsquo;t use any <em>Spring</em> resources, we were just using it to provide us with an instance of the <code>TempService</code> class, something that we could easily solve. For this specific case, we can simply remove all Spring annotations and instantiate our class manually, where we would have the following test class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TempApplicationTests</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> TempService service <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TempService();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test</span>() {
</span></span><span style=display:flex><span>        assertEquals(<span style=color:#e6db74>&#34;Nothing&#34;</span>, service.<span style=color:#a6e22e>get</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>With this change, we were able to get the same test coverage, but our test finishes with just <code>15ms</code>, representing a runtime 15 times less than when using annotations.</p><h2 id=conclusion>Conclusion</h2><p>As we can see, simple scenarios, where we just use Spring to inject our components, we can easily replace the use of test annotations with native Java resources. With this we can drastically reduce the execution time of our tests and when we scale this to real applications, with different scenarios, we can notice a significant drop in the total execution time of the tests.</p><p>However, it is important to clarify that this is not a solution that should be applied to all cases, as your application can and probably should have scenarios in which it would be necessary to use the context for the construction and execution of the tests. As an example for these cases, we can mention tests that aim to identify if all dependencies for our classes have been provided, tests of mappings and HTTP requests or even connections to databases.</p><p>Anyway, this approach should not be followed for all cases, but it can certainly be applied in several of them and consequently would bring a reduction in the total time of execution of the tests.</p></div><footer><div class=stats><ul class=tags><li><a class=article-terms-link href=https://www.rapatao.com/tags/spring/>spring</a></li><li><a class=article-terms-link href=https://www.rapatao.com/tags/springboot/>springboot</a></li><li><a class=article-terms-link href=https://www.rapatao.com/tags/java/>java</a></li><li><a class=article-terms-link href=https://www.rapatao.com/tags/tests/>tests</a></li></ul></div></footer></article><article class=post><div id=reaktions></div><script lang=application/javascript defer src=https://reaktions.rapatao.com/reaktions.js></script><noscript>Please enable JavaScript to react with this post</noscript></article><div class=pagination><a href=https://www.rapatao.com/posts/2022-01/build-tests-using-kotlin-junit-mockk/ class="button left"><span>Build tests using Kotlin, JUnit and MockK</span></a>
<a href=https://www.rapatao.com/posts/2021-03/thinking-in-graalvm-should-i-use-quarkus-or-micronaut/ class="button right"><span>Thinking in GraalVM? Should I use Quarkus or Micronaut?</span></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>Recent Posts</h1></header><article class=mini-post><a href=https://www.rapatao.com/posts/2023-11/destructuring-in-kotlin/ class=image style="--bg-image:url('https://www.rapatao.com/images/posts/pexels-cottonbro-studio-3944307.jpg')"><img class=stretchV src=https://www.rapatao.com/images/posts/pexels-cottonbro-studio-3944307.jpg alt="Destructuring in Kotlin"></a><header><h2><a href=https://www.rapatao.com/posts/2023-11/destructuring-in-kotlin/>Destructuring in Kotlin</a></h2><time class=published datetime="2023-11-10 17:00:00 +0000 UTC">November 10, 2023</time></header></article><article class=mini-post><a href=https://www.rapatao.com/posts/2023-10/contract-first-vs-code-first-api-documentation/ class=image style="--bg-image:url('https://www.rapatao.com/images/posts/pexels-rdne-stock-project-7841410.jpg')"><img class=stretchV src=https://www.rapatao.com/images/posts/pexels-rdne-stock-project-7841410.jpg alt="Contract-First VS Code-First API Documentation"></a><header><h2><a href=https://www.rapatao.com/posts/2023-10/contract-first-vs-code-first-api-documentation/>Contract-First VS Code-First API Documentation</a></h2><time class=published datetime="2023-10-08 09:00:00 +0000 UTC">October 8, 2023</time></header></article><article class=mini-post><a href=https://www.rapatao.com/posts/2023-09/cap-theorem/ class=image style="--bg-image:url('https://www.rapatao.com/images/posts/light-bulds.jpg')"><img class=stretchV src=https://www.rapatao.com/images/posts/light-bulds.jpg alt="CAP Theorem"></a><header><h2><a href=https://www.rapatao.com/posts/2023-09/cap-theorem/>CAP Theorem</a></h2><time class=published datetime="2023-09-22 09:00:00 +0000 UTC">September 22, 2023</time></header></article><footer><a href=https://www.rapatao.com/posts/ class=button>See More</a></footer></section></section><footer id=site-footer><ul class=socnet-icons><li><a href=//github.com/rapatao target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//linkedin.com/in/rapatao target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//instagram.com/luizrapatao target=_blank rel=noopener title=Instagram class="fab fa-instagram"></a></li><li><a href=//twitter.com/rapatao target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li><li><a href=mailto:rapatao@rapatao.com target=_blank title=Email class="far fa-envelope"></a></li></ul><p class=copyright>© 2023 rapatao.com<br>Theme: <a href=https://github.com/pacollins/hugo-future-imperfect-slim target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>A <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP port</a> | Powered by <a href=https://gohugo.io/ title=0.126.1 target=_blank rel=noopener>Hugo</a></p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a><script src=https://www.rapatao.com/js/bundle.min.16c4006ade78f79e839681c2846a091e2385b4b076497677a08afc2dfda951b4.js integrity="sha256-FsQAat54956DloHChGoJHiOFtLB2SXZ3oIr8Lf2pUbQ="></script><script src=https://www.rapatao.com/js/add-on.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8575ea838221496eb4ac5f867d0d5d8f"}'></script></div></body></html data-check="rapatao.com">